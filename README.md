공부하다가 이건왜 ? 궁금한것을 기록하고 답변을 찾는 브랜치

## VM위에 VM을 띄울수는 없을까 ?? - 해결 : 가능!

https://osb330.tistory.com/5

가능하다 ! 하지만 이렇게 운영체제를 운영하게 되면 2중으로 싸인 운영체제는 하이퍼바이저를 2개 거쳐야 하기때문에 1개만 거쳐도 무거운 운영체제를 더무겁게 해서 매우 성능상 안좋다.

컨테이너는 운영체제 위에서 작동하며 호스트 OS와 커널을 공유하지만 VM은 자신만의 운영체제를 가지며(게스트 OS) 자체 커널을 가지고있다. 

## HTTPS 비대칭키?

비대칭키를 통해서 암호화 복호화를 할경우 서버측에서 정해놓은 공개키를 이용해서 클라이언트가 복호화를 진행하게 된다.

하지만 공개키는 만천하에 공개되어있고 , 서버의 데이터가 중간에 탈취당하거나 이상한 사람에게 간다면 이거 위험한거 아닌가 ?

그렇기 떄문에 존재하는것이 CA , CA에 서버는 공개키를 제공하고 CA로부터 공개키를 제공받은 클라이언트는 인증된 사용자이므로 결국 이상한사람은 공개키를 가질수 없다 !

하지만 매번 공개키로 암호화하고 개인키로 복호화 하고 반대로 수행하는것은 리소스 활용면에서 좋지않다 , 그렇기에 처음에 대칭키를 공개키로 복호화해서 서버로 전송하는 작업을 통해서 서버는 클라이언트와 대칭키를 공유하게 되고 이후 서버는 마음놓고 데이터를 전송해도 된다.

대칭키 방식으로 암복호화하며 데이터를 주고받는다면 안전하다.

다만 대칭키를 양쪽이 모두 안전하게 가지고 있는 상태에 도달하기 위해 비대칭키 방식이 필요하다.

서버의 공개키로 암호화해서 전송한다면 클라이언트의 전송은 안전하게 된다.

서버가 내 정보를 보내도 되는 신뢰할만한 사이트인지에 대해 확인하기 위해 CA 역할이 필요하다.

서버는 CA의 개인키로 암호화된 자신의 인증서를 응답해주고 브라우저는 이를 CA 공개키로 복호화한다.

복호화 결과로 나온 서버의 공개키로 대칭키를 암호화해서 전달한다.

이후로는 안전하게 대칭키로 데이터를 주고받는다.

신뢰할 수 있는 브라우저를 사용하는 것부터가 중요한 첫 단추가 될 것 같습니다.<< 대한민국 공무원들이 익스플로러 쓰는 이유 ?

가령 엄한 브라우저를 사용하면, 잘못된 CA 목록이 들어있어서

악의적인 사이트를 안전하다고 사용자에게 보여줄 수도 있을테니까요. 

## why 제네릭은 레퍼클래스만 ? - 해결

제네릭을 사용하려면 Object로 변환될 수 있어야하는데, 원시 타입들은 Object로 치환될 수 없기 때문에 사용이 불가능합니다.

## 자바 리플렉션은 왜 보안상의 취약점이 존재할까 ? - 해결

기본적으로 동적으로 실행되는 코드는 보안상에 취약점이 존재한다.

첫번째로 code injection으로 주입된 코드를 동적으로 실행하기 때문에 xss나 code injection에 취약하다.

리플렉션은 런타임시에 동적으로 메서드나 클래스를 로딩해오기 때문에 이러한 취약점이 존재한다고 할수있다.

## 리플렉션을 사용하면 항상 느린가 ? - 해결

그것은 아니다. 리플렉션을 적절히 사용하면 성능상의 이점을 얻을수 있다.

그 예시가 많이 존재한다.

첫번째는 스프링의 ioc컨테이너다, 리플렉션을 사용해 만들어진 프레임워크로 객체를 자동으로 관리해 개발에 편의성을 제공해준다.

두번째는 자바의 직렬화 기능이다.

객체를 직렬화(Serialization) 해야 할 경우 Serializable 인터페이스를 구현한다. 그리고, 직렬화된 객체를 읽기 위해서는 java.io.ObjectInputStream 클래스의 readObject() 메서드를 이용한다. 필요에 따라 Serializable 인터페이스를 구현한 클래스가 readObject() 메서드를 구현할 수도 있다. 이때, java.io.ObjectInputStream 클래스의 readObject() 메서드는 내부적으로 Reflection을 이용하여 직렬화된 객체의 readObject() 메서드를 호출한다

또한 리플렉션은 컴파일시 에러나 익셉션체킹을 받지못하기 때문에 문제를 발생시킬수 있다는 단점이 존재하는대 , 이는 런타임시 적절한 익셉션던지기나 에러메시지를 통해서 테스트하기 쉽게 만들수있다.

- 보안상의 취약점을 보완하는 법 

## 개발시 성능만을 고려하는것이 맞는가 ? - 해결

성능만을 좇아서 개발을 진행하면 객체지향원칙을 어길가능성이 있고 이는 나쁜 결과를 나을수도 있기때문에 성능만을 좇기보다는 객체지향의 원칙을 지키는 선에서 좇는것이 좋다.

## 멀티 스레드환경에서 캐시가 끼치는 영향

```java

import java.util.concurrent.TimeUnit;

public class Main {
    private static boolean stopRequested;
    public static void main(String[] args) throws InterruptedException{
        System.out.println("hello world!");
        Thread backgroundThread = new Thread(() -> {
            int i=0;
            while(!stopRequested){
                i++;
            }
        });
        backgroundThread.start();
        TimeUnit.SECONDS.sleep(1);
        stopRequested = true;
    }
}

```
해당 코드에서 메인스레드는 request값을 true로 바꿔주지만 backgroundthread는 cpu캐시를 참조하고있고, 최근에 참조된값이기 때문에 바뀌지않고 계속 해당 캐시값을 참조하기때문에 무한루프가 돌아가게 된다.

이를 방지하기위해서는 atomicInteger, concurrentHashMap등을 활용할수있겠다.
혹은Volatile을 사용해 바로 메모리를 참조하게 할수도있다.
